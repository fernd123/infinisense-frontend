<app-modal title="{{modalTitle}}">
  <form [formGroup]="reasonForm" (ngSubmit)="submit()">
    <div class="form-group">
      <label for="name"> {{ 'name' | translate }}
      </label>
      <input type="text" class="form-control" id="name" placeholder=" {{ 'name' | translate }}" formControlName="name"
        [ngClass]="{'alert-danger' : !this.reasonForm.get('name').valid && (this.reasonForm.get('name').touched || this.reasonForm.get('name').dirty) }">
      <div class="invalid-feedback" *ngIf="!this.reasonForm.get('name').valid">
        {{ this.reasonForm.get('name').getError('message') }}
      </div>
    </div>

    <div class="form-group">
      <label for="name"> {{ 'description' | translate }}</label>
      <input type="text" class="form-control" id="description" placeholder=" {{ 'description' | translate }}"
        formControlName="description">
    </div>

    <div class="form-check form-check-flat form-check-primary" *ngIf="this.reasonUrl != null">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" formControlName="active">
        {{ 'active' | translate }}
        <i class="input-helper"></i>
      </label>
    </div>

    <div class="form-check form-check-flat form-check-primary">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" formControlName="isproject">
        {{ 'project' | translate }}
        <i class="input-helper">
        </i>
      </label>
    </div>

    <div class="form-check form-check-flat form-check-primary" *ngIf="this.reasonForm.get('isproject').value">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" formControlName="finished">
        {{ 'finished' | translate }}
        <i class="input-helper">
        </i>
      </label>
    </div>

    <div class="mt-4" *ngIf="this.reasonForm.get('isproject').value">
      <div>
        <div class="form-row">
          <div class="col-md-6 mb-3">
            <label for="name"> {{ 'user.company' | translate }}</label>
            <input type="text" class="form-control" placeholder="Empresa" aria-label="Recipient's username"
              aria-describedby="basic-addon2" formControlName="company"
              [ngClass]="{'alert-danger' : !this.reasonForm.get('company').valid && (this.reasonForm.get('company').touched || this.reasonForm.get('email').dirty) }">
            <div class="invalid-feedback" *ngIf="!this.reasonForm.get('email').valid">
              {{ this.reasonForm.get('company').getError('message') }}
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label for="name"> {{ 'user.email' | translate }}</label>
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Email" aria-label="Recipient's username"
                aria-describedby="basic-addon2" formControlName="email"
                [ngClass]="{'alert-danger' : !this.reasonForm.get('email').valid && (this.reasonForm.get('email').touched || this.reasonForm.get('email').dirty) }">
              <div class="input-group-append" *ngIf="!projectInDb">
                <button type="button" class="btn btn-outline-primary btn-sm" (click)="addNewMail()">
                  <i class="mdi mdi-plus ml-1"></i></button>
              </div>
              <div class="invalid-feedback" *ngIf="!this.reasonForm.get('email').valid">
                {{ this.reasonForm.get('email').getError('message') }}
              </div>
            </div>
          </div>

        </div>

        <div id="newMailId"></div>
      </div>

    </div>

    <div class="mt-4">
      <ngb-accordion [closeOthers]="true">
        <!--activeIds="collapse-1"-->
        <ngb-panel id="collapse-1" title="{{associationtitle}}">
          <ng-template ngbPanelContent>
            <div class="form-group">
              <button type="button" class="btn btn-warning btn-sm"
                (click)="this.reasonForm.get('plant').setValue(null); this.reasonForm.get('plantCoordinate').setValue(null);">
                {{ 'clear' | translate }}</button>
            </div>
            <div class="form-group">
              <label for="name"> {{ 'visit.plant' | translate }}</label>
              <select class="form-control" id="plant" formControlName="plant" (change)="loadPlantZone(true)">
                <option [value]="plant._links.plantCoordinate.href" *ngFor="let plant of plantList">{{plant.name}}
                </option>
              </select>
            </div>

            <div class="form-group">
              <label for="name"> {{ 'visit.zone' | translate }}</label>
              <select class="form-control" id="plantCoordinate" formControlName="plantCoordinate">
                <option [value]="plantCoordinate._links.self.href" *ngFor="let plantCoordinate of plantZoneList">
                  {{plantCoordinate.name}}
                </option>
              </select>
            </div>

          </ng-template>
        </ngb-panel>
      </ngb-accordion>
    </div>

  </form>

  <div class="modal-footer">
    <button type="button" class="btn btn-danger btn-sm" (click)="delete()" *ngIf="this.reasonUrl != null">
      {{ 'delete' | translate }}</button>
    <button type="button" class="btn btn-success btn-sm" (click)="submit()" [disabled]="this.reasonForm.invalid">
      {{ 'save' | translate }}</button>
    <button type="button" class="btn btn-light btn-sm" data-dismiss="modal" (click)="closeModal()">
      {{ 'cancel' | translate }}</button>
  </div>

</app-modal>